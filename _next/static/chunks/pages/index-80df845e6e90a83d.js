(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8581:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(3773)}])},3773:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return N}});var t=r(5893),o=r(7294),i=function(e){var n=e.canvasRef,r=e.canvasConfig,i=e.brushColor,a=e.paintInfo,l=function(e){var r=n.current;return e.touches?{x:e.touches[0].pageX-r.offsetLeft,y:e.touches[0].pageY-r.offsetTop}:{x:e.pageX-r.offsetLeft,y:e.pageY-r.offsetTop}},c=function(){var e=n.current;e.addEventListener("mousemove",d),e.addEventListener("touchmove",d)},s=function(){var e=n.current;e.removeEventListener("mousemove",u),e.removeEventListener("mousemove",d),e.removeEventListener("touchmove",u),e.removeEventListener("touchmove",d)},d=function(e){e.preventDefault();var n=l(e),t=Math.floor(n.x/r.gridWidth),o=Math.floor(n.y/r.gridWidth),c=1e4*t+o;a.get(c,i)!=i&&(a.set(c,i),h(t,o,i))},u=function(e){e.preventDefault(),s(),function(){var e=n.current;e.addEventListener("mousemove",u),e.addEventListener("touchmove",u)}();var t=l(e),o=Math.floor(t.x/r.gridWidth),c=Math.floor(t.y/r.gridWidth),d=1e4*o+c;void 0!=a.get(d)&&(a.delete(1e4*o+c,i),h(o,c,r.bgColor))},h=function(e,t,o){var i=n.current.getContext("2d");i.fillStyle=o,i.fillRect(e*r.gridWidth+1,t*r.gridWidth+1,r.gridWidth-2,r.gridWidth-2)};return(0,o.useEffect)((function(){var e=n.current,t=e.getContext("2d");e.width=r.width,e.height=r.height,t.fillStyle=r.bgColor,t.fillRect(0,0,e.width,e.height),t.lineWidth=.5,t.strokeStyle=r.gridColor;for(var o=r.gridWidth;o<e.width;o+=r.gridWidth)t.beginPath(),t.moveTo(o,0),t.lineTo(o,e.height),t.closePath(),t.stroke();for(var i=r.gridWidth;i<e.height;i+=r.gridWidth)t.beginPath(),t.moveTo(0,i),t.lineTo(e.width,i),t.closePath(),t.stroke();a.forEach((function(e,n){h(Math.floor(n/1e4),n%1e4,e)}))}),[r]),(0,o.useEffect)((function(){var e=n.current;return e.addEventListener("mousedown",c),e.addEventListener("touchstart",c),e.addEventListener("mouseup",s),e.addEventListener("mouseleave",s),e.addEventListener("touchend",s),function(){e.removeEventListener("mousedown",c),e.removeEventListener("touchstart",c),e.removeEventListener("mouseup",s),e.removeEventListener("mouseleave",s),e.removeEventListener("touchend",s)}}),[i,r]),(0,o.useEffect)((function(){var e=n.current;return e.addEventListener("click",d),e.addEventListener("contextmenu",u),function(){e.removeEventListener("click",d),e.removeEventListener("contextmenu",u)}}),[i,r]),(0,t.jsx)("canvas",{ref:n,className:"border-0 rounded-lg shadow-lg"})};i.defaultProps={canvasConfig:{width:500,height:500,bgColor:"white",gridWidth:20,gridColor:"#eee"},brushColor:"#f87171"};var a=i,l=r(713),c=r(7779),s=r.n(c);function d(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function u(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){d(e,n,r[n])}))}return e}var h=function(e){var n=e.setBrushColor,r=(0,o.useState)({displayColorPicker:!1,history:[],color:{r:"87",g:"96",b:"111",a:"1"}}),i=r[0],a=r[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{onClick:function(){a(u({},i,{displayColorPicker:!i.displayColorPicker}))},className:"mx-4 w-12 h-12 inline-block rounded-xl shadow-xl shadow-gray-400",style:{background:"rgba(".concat(i.color.r,", ").concat(i.color.g,", ").concat(i.color.b,", ").concat(i.color.a,")")}}),i.displayColorPicker?(0,t.jsxs)("div",{className:s().popover,children:[(0,t.jsx)("div",{className:s().cover,onClick:function(){var e="rgba(".concat(i.color.r,",").concat(i.color.g,",").concat(i.color.b,",").concat(i.color.a,")");i.history.includes(e)||i.history.push(e),n(e),a(u({},i,{displayColorPicker:!1}))}}),(0,t.jsx)(l.xS,{color:i.color,presetColors:i.history,onChange:function(e){a(u({},i,{color:e.rgb}))},width:240})]}):null]})},g=function(e){var n=e.brushColor,r=e.setBrushColor,o=["#f87171","#fb923c","#facc15","#4ade80","#60a5fa","#c084fc"];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{onClick:function(){return r(o[0])},className:"color-circle bg-red-400  ring-red-200 ring-offset-red-300 ".concat(n==o[0]?"ring-4":"hover:ring-4")}),(0,t.jsx)("span",{onClick:function(){return r(o[1])},className:"color-circle bg-orange-400 ring-orange-200 ring-offset-orange-300 ".concat(n==o[1]?"ring-4":"hover:ring-4")}),(0,t.jsx)("span",{onClick:function(){return r(o[2])},className:"color-circle bg-yellow-400 ring-yellow-200 ring-offset-yellow-300 ".concat(n==o[2]?"ring-4":"hover:ring-4")}),(0,t.jsx)(h,{setBrushColor:r}),(0,t.jsx)("span",{onClick:function(){return r(o[3])},className:"color-circle bg-green-400 ring-green-200 ring-offset-green-300 ".concat(n==o[3]?"ring-4":"hover:ring-4")}),(0,t.jsx)("span",{onClick:function(){return r(o[4])},className:"color-circle bg-blue-400 ring-blue-200 ring-offset-blue-300 ".concat(n==o[4]?"ring-4":"hover:ring-4")}),(0,t.jsx)("span",{onClick:function(){return r(o[5])},className:"color-circle bg-purple-400 ring-purple-200 ring-offset-purple-300 ".concat(n==o[5]?"ring-4":"hover:ring-4")})]})};function f(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function v(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){f(e,n,r[n])}))}return e}var b=function(e){var n=e.canvasConfig,r=e.setCanvasConfig;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("nav",{className:"inline-flex rounded-full shadow-md",children:[(0,t.jsx)("button",{onClick:function(){n.width>2*n.gridWidth&&r(v({},n,{width:n.width-n.gridWidth}))},className:"btn-sm rounded-l-full border-gray-300 bg-white text-gray-500 hover:bg-gray-50",children:(0,t.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})}),(0,t.jsx)("p",{className:"btn bg-indigo-50 border-indigo-500 text-indigo-600",children:"\u753b\u5e03\u5bbd\u5ea6"}),(0,t.jsx)("button",{onClick:function(){n.width<document.body.clientWidth-20&&r(v({},n,{width:n.width+n.gridWidth}))},className:"btn-sm rounded-r-full border-gray-300 bg-white text-gray-500 hover:bg-gray-50",children:(0,t.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})})]}),(0,t.jsxs)("nav",{className:"inline-flex rounded-full shadow-md",children:[(0,t.jsx)("button",{onClick:function(){n.gridWidth>4&&r(v({},n,{gridWidth:n.gridWidth-2}))},className:"btn-sm rounded-l-full border-gray-300 bg-white text-gray-500 hover:bg-gray-50",children:(0,t.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})}),(0,t.jsx)("p",{className:"bg-indigo-50 border-indigo-500 text-indigo-600 btn",children:"\u7f51\u683c\u5927\u5c0f"}),(0,t.jsx)("button",{onClick:function(){2*n.gridWidth<n.width&&r(v({},n,{gridWidth:n.gridWidth+2}))},className:"btn-sm rounded-r-full border-gray-300 bg-white text-gray-500 hover:bg-gray-50",children:(0,t.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})})]}),(0,t.jsxs)("nav",{className:"inline-flex rounded-full shadow-md",children:[(0,t.jsx)("button",{onClick:function(){n.height>2*n.gridWidth&&r(v({},n,{height:n.height-n.gridWidth}))},className:"btn-sm rounded-l-full border-gray-300 bg-white text-gray-500 hover:bg-gray-50",children:(0,t.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})}),(0,t.jsx)("p",{className:" bg-indigo-50 border-indigo-500 text-indigo-600 btn",children:"\u753b\u5e03\u9ad8\u5ea6"}),(0,t.jsx)("button",{onClick:function(){n.height<document.body.clientHeight-20&&r(v({},n,{height:n.height+n.gridWidth}))},className:"btn-sm rounded-r-full border-gray-300 bg-white text-gray-500 hover:bg-gray-50",children:(0,t.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})})]})]})},m=r(3162);function p(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var r=[],t=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(t=(a=l.next()).done)&&(r.push(a.value),!n||r.length!==n);t=!0);}catch(c){o=!0,i=c}finally{try{t||null==l.return||l.return()}finally{if(o)throw i}}return r}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var x=function(e){var n=e.canvasRef,r=e.canvasConfig,o=e.setCanvasConfig,i=e.paintInfo,a=e.setPaintInfo;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{id:"input",type:"file",accept:".px",className:"hidden",onChange:function(){var e=new FileReader;e.readAsText(document.getElementById("input").files[0]),e.onload=function(e){var n=JSON.parse(e.target.result),r=new Map;Object.entries(n.paintInfo).forEach((function(e){var n=p(e,2),t=n[0],o=n[1];r.set(parseInt(t),o)})),a(r),o(n.canvasConfig)}}}),(0,t.jsx)("button",{onClick:function(){var e={canvasConfig:r,paintInfo:Object.fromEntries(i)},n=new Blob([JSON.stringify(e)],{type:"text/plain;charset=utf-8"});(0,m.saveAs)(n,"pixeel.px")},className:"btn-round border-gray-300 text-white bg-indigo-600 hover:bg-indigo-700",children:"\u4fdd\u5b58(.px)"}),(0,t.jsx)("button",{onClick:function(){n.current.toBlob((function(e){(0,m.saveAs)(e,"pixxel.png")}))},className:"btn-round border-gray-300 text-white bg-green-600 hover:bg-green-700 ",children:"\u4fdd\u5b58(.png)"}),(0,t.jsx)("button",{onClick:function(){document.getElementById("input").click()},className:"btn-round border-gray-300 text-white bg-amber-600 hover:bg-amber-700 ",children:"\u8f7d\u5165(.px)"})]})},w=r(9008),y=r(7792),j=function(e){var n=e.children;return(0,t.jsxs)("div",{className:"contaner min-h-screen flex flex-col space-y-4 items-center bg-slate-200 ",children:[(0,t.jsxs)(w.default,{children:[(0,t.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=0.6"}),(0,t.jsx)("title",{children:"Pixxel"})]}),(0,t.jsx)(y.Z,{href:"https://github.com/fzf404/Pixxel",bannerColor:"#64748b"}),n]})};function C(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function N(){var e=(0,o.useState)("#f87171"),n=e[0],r=e[1],i=(0,o.useState)(new Map),l=i[0],c=i[1],s=(0,o.useRef)(null),d=(0,o.useState)({width:500,height:500,bgColor:"white",gridWidth:20,gridColor:"#eee"}),u=d[0],h=d[1];return(0,o.useEffect)((function(){var e=document.body.clientWidth-40;u.width>e&&h(function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){C(e,n,r[n])}))}return e}({},u,{width:e}))}),[]),(0,t.jsxs)(j,{children:[(0,t.jsx)("div",{className:"mt-4 space-x-4",children:(0,t.jsx)(b,{canvasConfig:u,setCanvasConfig:h})}),(0,t.jsx)("div",{className:"",children:(0,t.jsx)(g,{setBrushColor:r,brushColor:n})}),(0,t.jsx)("div",{className:"",children:(0,t.jsx)(a,{width:"0",height:"0",canvasRef:s,canvasConfig:u,brushColor:n,paintInfo:l})}),(0,t.jsx)("div",{className:"space-x-4 space-y-2",children:(0,t.jsx)(x,{canvasRef:s,canvasConfig:u,setCanvasConfig:h,paintInfo:l,setPaintInfo:c})})]})}},7779:function(e){e.exports={popover:"picker_popover__0nNmt",cover:"picker_cover__po2H6"}}},function(e){e.O(0,[509,774,888,179],(function(){return n=8581,e(e.s=n);var n}));var n=e.O();_N_E=n}]);